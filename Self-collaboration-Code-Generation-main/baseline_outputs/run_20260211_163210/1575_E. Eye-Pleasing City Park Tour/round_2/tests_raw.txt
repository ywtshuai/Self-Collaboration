```
Input:
2 0
5 10
1 2 0

Output:
25
```

```
Input:
2 1
5 10
1 2 1

Output:
25
```

```
Input:
3 0
1 2 3
1 2 0
2 3 0

Output:
20
```

```
Input:
3 1
1 2 3
1 2 0
2 3 1

Output:
23
```

```
Input:
4 1
1 1 1 1
1 2 0
2 3 1
3 4 0

Output:
30
```

```
Input:
5 2
0 0 0 0 0
1 2 0
2 3 1
3 4 0
4 5 1

Output:
0
```

```
Input:
5 0
1 3 2 6 4
1 2 1
1 4 0
3 2 1
2 5 0

Output:
45
```

```
Input:
3 1
1 1 1
1 2 1
3 2 0

Output:
10
```

```
Input:
6 3
1000000000 1000000000 1000000000 1000000000 1000000000 1000000000
1 2 0
2 3 1
3 4 0
4 5 1
5 6 0

Output:
999999918
```